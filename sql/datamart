select
dcs.search_keyword,
count(distinct dcs.place_id) as places,
sum(fcs.rating) as rating,
sum(fcs.user_ratings_total) as user_ratings_total,
round(sum(fcs.rating) / sum(fcs.user_ratings_total),1) as average_rating
from `grand-water-473707-r8.osm_demo.dim_charging_station` dcs
inner join `grand-water-473707-r8.osm_demo.fact_charging_station` fcs
on fcs.place_id = dcs.place_id
group by all
order by 1
